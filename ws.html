<html>

<head>
    <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.5.0/socket.io.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js"></script> -->
</head>

<body>
    <div class="msgs"></div>
    <br />
    <hr />
    <hr />
    numero del cliente
    <input type="number" id="client-number" />
    <br />
    <br />
    mensaje
    <input type="mensaje" id="message" />
    <br />
    <br />
    <button onclick="emitEvent()">test send messages</button>
    <hr />
    <button onclick="test()">Test socket</button>
    <!-- <button onclick="redirect()">Test Conversation socket</button> -->
    <script>
        const socket = io('http://localhost:3003', {
            auth: {
                token: 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImVhNWY2NDYxMjA4Y2ZmMGVlYzgwZDFkYmI1MjgyZTkyMDY0MjAyNWEiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRmVybmFuZG8gUm9kcmlndWV6IiwiZW1haWwiOiJmZXJuYW5kb0BvbmJvdGdvLmNvbSIsInBhc3N3b3JkIjoib25ib3RnbzE1OSIsInJvbCI6InVzZXIiLCJkaXNwbGF5TmFtZSI6IkZlcm5hbmRvIFJvZHJpZ3VleiIsInVpZF9jbGllbnQiOm51bGwsInNlcnZpY2VzIjp7InRlcnJlbm8iOmZhbHNlLCJtaWJvdGFpciI6dHJ1ZSwidm9pY2Vib3QiOnRydWV9LCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vdmFsaGFsbGEtb25ib3RnbyIsImF1ZCI6InZhbGhhbGxhLW9uYm90Z28iLCJhdXRoX3RpbWUiOjE2NTc1NzE2NTMsInVzZXJfaWQiOiJNeUhkZmhPZFJ3WURwUUxPaGFQb0hXWGNYVXIxIiwic3ViIjoiTXlIZGZoT2RSd1lEcFFMT2hhUG9IV1hjWFVyMSIsImlhdCI6MTY1NzU3MTY1MywiZXhwIjoxNjU3NTc1MjUzLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJmZXJuYW5kb0BvbmJvdGdvLmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.M8sdMTMM-MyWEF8fnnjwEumOxcEDGCgInbf18QighIt5nj2HVhWLL_HqE3m-FHwCEupy39nE8b0EOwSh6iuJgxdaEd-Jri4nsL6odAptkA31EcBUsemiA7Dbtq6Eg0mxke8maUKlsEqu4f3m5Dxw_pf0hB-aBAv-uec8S-C3sbsNYn_48_7ny28LaKXyP2RzZM8W3IHw9sT8yPOA9hv-mJuo_e-5j18HBWozSNP15BzT8l_Y16dapd1HJvTFjjBScrgXzBqPQvahQ9VBjl64dMYPitfUnJ00_d-Uxfb2UtzRMgf5lSmOefkGOzAzQjeY7VWksH9Yw-vvCMuWnXKPmQ',
                project_uid: 'plhasjdjasdbjasdbhjasdba'
            }
        })
        // const socketConversations = io('http://localhost:3001/conversations', {
        //     withCredentials: true
        // })
        console.log(socket)
        const messageBox = document.querySelector('.msgs')

        socket.on('test', function (data) {
            console.log(data)
            messageBox.innerHTML += `<pre>${data}</pre><hr>`
        })
        // socketConversations.on('redirect_conversation', function (data) {
        //     console.log(data)
        //     messageBox.innerHTML += `${data.Body}<hr>`
        // })
        socket.on('connect', function () {
            console.log('Connected to messages')

            //socket.emit('connected')
            // socket.emit('identity', 0, (response) => console.log('Identity:', response))
        })

        socket.on('connect_failed', function () {
            document.write('Sorry, there seems to be an issue with the connection!')
        })
        socket.on('events', function (data) {
            console.log('event', data)
        })

        // socketConversations.on('connect', function () {
        //     console.log('Connected to Conversations')

        //     //socket.emit('connected')
        //     // socket.emit('identity', 0, (response) => console.log('Identity:', response))
        // })

        function emitEvent() {
            const cn = document.getElementById('client-number')
            const msg = document.getElementById('message')
            console.log('asdasd')
            socket.emit('send_message', { conversationId: 2, clientNumber: cn.value, channelNumber: '555', message: msg.value })
        }
        function test() {
            socket.emit('test', { conversationId: 45, manager: 'user', managerId: 45 })
        }
        function redirect() {
            socket.emit('redirect_conversation', { conversationId: 45, manager: 'user', managerId: 45 })
        }
        // function redirect() {
        //     socketConversations.emit('redirect_conversation', { conversationId: 45, manager: 'user', managerId: 45 })
        // }
        socket.on('exception', function (data) {
            console.log('event', data)
        })
        socket.on('disconnect', function () {
            console.log('Disconnected')
        })
    </script>
</body>

</html>
